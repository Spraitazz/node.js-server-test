<!doctype html>
<html>
  <head>
    <title>Sockets game</title>
    <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
  </head>
  
  <body>
  Hello from node.js!<br>  
  <div id="nameInput" style="display:none;">Enter your name <input type="text" maxLength="20"></div>
  <br><div id="status"></div><br><br>
  
  </body>
  
  <script>
  var socket = new WebSocket("ws://localhost:8000");
  var username;

  socket.onopen = function (event) {
  //socket opened  
  //wait for name input
   var input =  $("#nameInput > input");
   $("#nameInput").css("display", "block");
  input.keyup(function(event) {
  if (event.which==13) {
  var nameInput = input.val().trim();
  if (nameInput.length > 0){
  socket.send(nameInput);
  }  
  }
  });
  };
  
    
  socket.onmessage = function(event) {
  //got message
  var message = JSON.parse(event.data);
  console.log(message);

  switch(message.type) {
  
    case "username":
    //START NAME CHOOSING------------------------------------------------
      if (message.status === "nt") {
      //name taken
      $("#status").append("Sorry, this name is already taken");
      }
      else if (message.status === "nc") {
      //name chosen successfully
      $("#nameInput").css("display", "none");
      username = message.username;
      $("#status").append("Welcome, " + username);
      }
    break;
    //END NAME CHOOSING----------------------------------------------------
    
    case "online":
      $("body").append("Currently online: <br>");
      $.each(message.body, function(index, value) {
      $("body").append(value + "<br>");      
      });
      break;
      
    case "connected":
    
   
      break;
      
    case "disconnected":
    
    
    
      break;
    
  
  
  }
  };
  
  
  socket.onerror = function(event) {
  
  
  };
  
  socket.onclose = function(event) {
  
  };
  </script>






</html>